# Deploying to Vercel

This guide provides essential information for deploying this Flask application to Vercel, with a particular focus on database setup.

## Critical: Database Configuration for Vercel

Vercel's serverless functions have an ephemeral (temporary) filesystem. This means that the default SQLite database (`app.db`) **will not persist data** between deployments or function restarts. Any data written to the SQLite database will be lost.

**To ensure data persistence on Vercel, you MUST use an external, managed database service.**

### Recommended Steps:

1.  **Choose an External Database Service:**
    *   **Vercel Postgres:** A good option integrated with Vercel.
    *   Other cloud PostgreSQL providers (e.g., Neon, ElephantSQL, Supabase, AWS RDS, Google Cloud SQL).
    *   MySQL or other SQLAlchemy-compatible databases can also be used.

2.  **Set `DATABASE_URL` Environment Variable:**
    *   Once you have your external database, obtain its connection string.
    *   In your Vercel project settings (under "Environment Variables"), create a new environment variable named `DATABASE_URL` and set its value to your database's connection string.
    *   Example for PostgreSQL: `postgresql://user:password@host:port/database_name`

## Database Schema Management (Flask-Migrate)

This application is configured to use Flask-Migrate for managing database schema changes, but the migration scripts are not yet initialized in the repository (i.e., the `migrations/` directory is missing).

**You need to initialize and manage migrations locally first:**

1.  **Install Requirements:** Ensure all dependencies are installed:
    ```bash
    pip install -r requirements.txt
    ```

2.  **Initialize Flask-Migrate (run once):**
    *   This command creates a `migrations/` directory. You should commit this directory to your repository.
    ```bash
    flask db init
    ```

3.  **Create an Initial Migration:**
    *   This command inspects your models (in `app/models.py`) and generates the first migration script to create the database schema.
    ```bash
    flask db migrate -m "Initial database schema"
    ```

4.  **Apply the Migration to Your Local Database (Optional but Recommended):**
    *   If you have a local development database configured (e.g., via `DATABASE_URL` or the SQLite default), apply the migration:
    ```bash
    flask db upgrade
    ```

5.  **Commit Changes:**
    *   Add the newly generated `migrations/` directory and its contents to Git:
    ```bash
    git add migrations/
    git commit -m "Add initial Flask-Migrate setup and schema"
    ```
    *   Push these changes to your repository.

### Applying Migrations on Vercel:

*   **Initial Schema:** When you first connect your external database to Vercel (via `DATABASE_URL`), it will likely be empty. You need to apply your migrations to create the schema.
    *   One common way is to connect to your cloud database directly using a database management tool and run the SQL generated by Flask-Migrate (found in the migration script version files).
    *   Alternatively, you can temporarily point your local `flask db upgrade` command to the production database. **Use extreme caution with direct database credentials and operations.**
    *   Vercel's build process or deployment hooks might offer ways to run database migration commands, especially for Vercel-integrated databases like Vercel Postgres. Check Vercel's documentation for specific guidance.
*   **Subsequent Migrations:** For future schema changes, you'll generate new migration scripts locally (`flask db migrate -m "Your description of changes"`), commit them, and then devise a strategy to apply them to your production database (similar to the initial schema application).

## Summary for Vercel Deployment:

1.  Set up an external, persistent database service.
2.  Securely set the `DATABASE_URL` environment variable in your Vercel project settings.
3.  Locally, initialize Flask-Migrate (`flask db init`), generate an initial migration (`flask db migrate`), and commit the `migrations/` directory.
4.  Ensure your database schema is created/updated in the external database using these migration scripts.
5.  The application code includes `db.create_all()` in `app/__init__.py`. While this can set up initial tables for a local SQLite database (useful for quick local testing or previews), **Flask-Migrate is the correct and robust tool for managing the schema of your production database on Vercel.** Rely on your committed migration scripts for schema consistency.

```
